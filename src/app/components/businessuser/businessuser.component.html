<div *ngIf="user" class="wrap">
  <div class="cnt">
    <div class="center">

      <div *ngIf="!searchResult" class="navbar-inline">
        <nav class="navbar navbar-expand-md navbar-dark primary-color mb-5 no-content">
          <div class="mr-auto">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb clearfix d-none d-md-inline-flex pt-0">
                <li routerLink="/business/customers/1/10" class="breadcrumb-item grey-txt cursor underline">My
                  Customers</li>
                <li class="breadcrumb-item grey-txt-active" aria-current="page">{{user.customerName}}</li>
              </ol>
            </nav>
          </div>
        </nav>
      </div>

      <!-- <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li routerLink="/business/customers" class="breadcrumb-item breadcrumb-off">My Customers</li>
          <li class="breadcrumb-item active" aria-current="page">{{user.customerName}}</li>
        </ol>
      </nav> -->
    </div>
    <div class="center" *ngIf="user && user.userType == 'natural'">
      <div class="section section-bottom-margin">
        <div class="section-title">Customer Information</div>
        <div class="section-item">
          <span class="topic">ICS-No:</span><span class="txt-spacing">{{user.icsNo}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Email:</span><span class="txt-spacing">{{user.email}}</span>
        </div>
        <div class="section-item">
          <span class="topic">First Name:</span><span class="txt-spacing">{{user.firstname}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Last Name:</span><span class="txt-spacing">{{user.lastname}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Initials:</span><span class="txt-spacing">{{user.initials}}</span>
        </div>
        <div *ngIf="user.marriedName" class="section-item">
          <span class="topic">Married Name:</span><span class="txt-spacing">{{user.marriedName}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Gender:</span><span class="txt-spacing">{{user.gender}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Date of Birth:</span><span class="txt-spacing">{{user.birthDate}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Birth Country:</span><span class="txt-spacing">{{user.birthCountry}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Nationality:</span><span class="txt-spacing">{{user.nationality}}</span>
        </div>
        <div>&nbsp;</div>
        <div class="section-item">
          <span class="topic">Street Name:</span><span class="txt-spacing">{{user.address}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Street Number:</span><span class="txt-spacing">{{user.streetNumber}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Place:</span><span class="txt-spacing">{{user.place}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Country:</span><span class="txt-spacing">{{user.country}}</span>
        </div>
        <div class="section-item">
          <span class="topic">High Risk Country:</span><span class="txt-spacing">No</span>
        </div>
      </div>
    </div>


    <div class="center">
      <div class="section" *ngIf="user && user.userType == 'legal'">
        <div class="section-title">Account Information</div>
        <div class="section-item">
          <span class="topic">ICS-No:</span><span class="txt-spacing">{{user.icsNo}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Chamber Of Commerce No:</span><span class="txt-spacing">{{user.chamberNo}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Statutory Name:</span><span class="txt-spacing">{{user.customerName}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Trade Name:</span><span class="txt-spacing">{{user.tradeName}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Legal Form:</span><span class="txt-spacing">Sole Proprietorship</span>
        </div>
        <div class="section-item">
          <span class="topic">Street Name:</span>{{user.address}}<span class="txt-spacing"></span>
        </div>
        <div class="section-item">
          <span class="topic">Street Number:</span><span class="txt-spacing">{{user.streetNumber}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Country:</span><span class="txt-spacing">Cura&ccedil;ao</span>
        </div>
        <div class="section-item">
          <span class="topic">Email:</span><span class="txt-spacing">{{user.email}}</span>
        </div>
        <div class="section-item">
          <span class="topic">Telephone:</span><span class="txt-spacing">{{user.telephoneNo}}</span>
        </div>
        <div style="margin-top: 20px;">
          <div class="section-item">
            <span class="topic">Sector:</span><span class="txt-spacing">{{user.occupationalgroup}}</span>
          </div>
          <!-- <div class="section-item">
            <span class="topic">Business Activity:</span><span class="txt-spacing"></span>
          </div> -->
        </div>
      </div>
    </div>


    <div class="center">
      <div class="row-header">
        <div class="row-cols col-invNo">Risk Rating</div>
      </div>
      <div *ngFor="let item of riskRating; let i = index" class="row">
        <div style="padding: 0px;" class="row-wrapper">
          <table width="100%" cellspacing="0" cellpadding="15">
            <tr (click)="setRisk(item)">
              <td [ngClass]="item.selected || selectedRisk == item.riskrate ? item.color : ''"
                style="border-style: solid; text-align: center; padding: 0; border-width: 0 1px 0 0; border-color: #efefef;"
                valign="middle" width="30">
                <div style="float:left; width: 30px;">
                  <i style="color:#fff;" class="fas fa-check"></i>
                </div>
              </td>
              <td width="170">
                {{item.riskrate}}
              </td>
              <td>
                &nbsp;
              </td>
              <td style="text-align: right;">
                &nbsp;
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div style="height: 50px;">
        &nbsp;
      </div>
    </div>


    <div *ngIf="user && user.userType == 'natural'" class="center">
      <div class="row-header">
        <div class="row-cols col-doc-name">Identification Document</div>
        <div class="row-cols col-date">Document No</div>
        <div class="row-cols col-date">Expiration Date</div>
        <div class="row-cols col-date">Upload By</div>
        <div class="row-cols col-indicator">Verified</div>
        <div *ngIf="!globals.expired" class="add-btn"><i routerLink="/documents/add/id/{{user.icsNo}}" class="fad fa-plus-circle"></i></div>
      </div>
      <div *ngIf="!identificationDocuments">
        <div style="padding: 15px;" class="row row-items">
          No documents available
        </div>
      </div>
      <div *ngIf="identificationDocuments">
        <div *ngFor="let item of identificationDocuments; let i = index" class="row row-items">
          <table width="100%">
            <tr>
              <td width="50" style="height: 51px; padding: 0 15px;">
                <i *ngIf="item.documentExtension === 'docx'" class="fad fa-file-word docIcon"></i>
                <i *ngIf="item.documentExtension === 'pdf'" class="fad fa-file-pdf docIcon"></i>
                <i *ngIf="item.documentExtension === 'xlsx'" class="fad fa-file-excel docIcon"></i>
                <i *ngIf="item.documentExtension === 'png' || item.documentExtension === 'jpg'"
                  class="fad fa-file-image docIcon"></i>
              </td>
              <td (click)="openDoc(item, action)" width="214">
                {{item.documentName}}
              </td>
              <td (click)="openDoc(item, action)" width="200">
                <span>
                  {{item.documentNr}}
                </span>
              </td>
              <td (click)="openDoc(item, action)" width="200">
                <span>
                  {{item.formattedExpirationDate}}
                </span>
              </td>
              <td width="200" (click)="openDoc(item, action)">
                <span>{{item.uploadAccount}}</span>
              </td>
              <td>
                <span>{{item.verified == '1' ? 'Yes' : 'No'}}</span>
              </td>
            </tr>
          </table>
        </div>
        <div class="row-footer">
          <span routerLink="/business/userids/{{user.icsNo}}" class="bottom-button">All
            Identification Documents&nbsp;&nbsp; <i class="fas fa-external-link"></i></span>
        </div>
      </div>
    </div>


    <div class="center">
      <div class="row-header">
        <div class="row-cols col-doc-name">Other Documents</div>
        <div class="row-cols col-date">Document No</div>
        <div class="row-cols col-date">Date of Issue</div>
        <div class="row-cols col-date">Upload By</div>
        <div class="row-cols col-indicator">Verified</div>
        <div *ngIf="!globals.expired" class="add-btn"><i routerLink="/documents/add/other/{{user.icsNo}}" class="fad fa-plus-circle"></i></div>
      </div>
      <div *ngIf="!otherDocuments">
        <div style="padding: 15px;" class="row row-items">
          No documents available
        </div>
      </div>
      <div *ngIf="otherDocuments">
        <div *ngFor="let item of otherDocuments; let i = index" class="row row-items">
          <table width="100%">
            <tr>
              <td width="50" style="height: 51px; padding: 0 15px;">
                <i *ngIf="item.documentExtension === 'docx'" class="fad fa-file-word docIcon"></i>
                <i *ngIf="item.documentExtension === 'pdf'" class="fad fa-file-pdf docIcon"></i>
                <i *ngIf="item.documentExtension === 'xlsx'" class="fad fa-file-excel docIcon"></i>
                <i *ngIf="item.documentExtension === 'png' || item.documentExtension === 'jpg'"
                  class="fad fa-file-image docIcon"></i>
              </td>
              <td (click)="openDoc(item, action)" width="214">
                {{item.documentName}}
              </td>
              <td (click)="openDoc(item, action)" width="200">
                <span>
                  <span *ngIf="item.permission == '1'">{{item.documentNr}}</span>
                </span>
              </td>
              <td (click)="openDoc(item, action)" width="200">
                <span>
                  {{item.dateIssue}}
                </span>
              </td>
              <td width="200" (click)="openDoc(item, action)">
                <span>{{item.uploadAccount}}</span>
              </td>
              <td>
                <span>{{item.verified == '1' ? 'Yes' : 'No'}}</span>
              </td>

            </tr>
          </table>
        </div>

        <div class="row-footer">
          <span routerLink="/business/userdocuments/{{user.icsNo}}" class="bottom-button">All Documents&nbsp;&nbsp;<i class="fas fa-external-link"></i></span>
        </div>
      </div>
    </div>


    <div *ngIf="user">
      <div class="center row-header">
        Actions
      </div>
      <div routerLink="/requestdocument/{{user.icsNo}}" class="row row-items">
        <div class="row-wrapper">
          <div class="row-left">
            Request Document
          </div>
        </div>
      </div>
      <div routerLink="/business/newtransaction/{{user.icsNo}}" class="row row-items">
        <div class="row-wrapper">
          <div class="row-left">
            Create New Transaction
          </div>
        </div>
      </div>
      <div (click)="goToTransactions(transactions, user)" class="row row-items">
        <div class="row-wrapper">
          <div class="row-left">
            View Past Transaction
          </div>
          <div style="text-align: center; line-height: 55px;" class="button-right">
            <span *ngIf="transactions; else noTransaction">{{transactions.length}}</span>
            <ng-template #noTransaction>
              <span>
                0
              </span>
            </ng-template>
          </div>
        </div>
      </div>
      <div (click)="goToReports(reports, user)" class="row row-items">
        <div class="row-wrapper">
          <div class="row-left">
            View Saved Reports
          </div>
          <div style="text-align: center; line-height: 55px;" class="button-right">
            <span *ngIf="reports; else noReports">{{reports.length}}</span>
            <ng-template #noReports>
              <span>
                0
              </span>
            </ng-template>
          </div>
        </div>
      </div>
      <div (click)="goToReports(reports, user)" class="row row-items">
        <div class="row-wrapper">
          <div class="row-left">
            View FIU Reports
          </div>
          <div style="text-align: center; line-height: 55px;" class="button-right">
            <span *ngIf="reports; else noReports">{{reports.length}}</span>
            <ng-template #noReports>
              <span>
                0
              </span>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
    <div style="height: 150px;">
      &nbsp;
    </div>
  </div>
</div>


<div class="modal fade" id="fyDocModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-h1">
        <div class="model-close-container">
          <i data-dismiss="modal" class="fal fa-times"></i>
        </div>
      </div>
      <div class="modal-h">
        <div *ngIf="modal" class="modal-title">
          Are you sure you want to {{modal}} this item?
        </div>
      </div>
      <div class="modal-body">
        <button (click)="updateDocs(modal)" class="button lime-green">Yes</button>
        <button data-dismiss="modal" class="button weird-purple">No</button>
      </div>
    </div>
  </div>
</div>

<ng-template #docContent let-modal>
  <form [formGroup]="insertIdForm">
    <div class="my-modal-header">
      <i (click)="modal.dismiss('Cross click')" class="fal fa-times my-modal-close-btn"></i>
    </div>
    <div class="my-modal-body">
      <div class="my-modal-title">UPLOAD IDENTIFICATION DOCUMENT</div>
      <div>
        <select class="selectbox" formControlName="docName">
          <option value="">Select Identification Type</option>
          <option value="Passport">Passport</option>
          <option value="Drivings License">Drivings License</option>
          <option value="Id Card">Id Card</option>
        </select>
      </div>
      <div><input class="input" type="text" formControlName="docNo" placeholder="Document No" /></div>
      <div><input type="text" placeholder="Date of Issue" (click)="e.toggle()" formControlName="dateOfIssue"
          class="input" ngbDatepicker #e="ngbDatepicker" /></div>
      <div><input type="text" formControlName="idPlaceOfIssue" placeholder="Place of Issue" /></div>
      <div><input type="text" formControlName="idCountryOfIssue" placeholder="Country Issued" /></div>
      <div><input type="text" formControlName="idExpirationDate" (click)="f.toggle()" ngbDatepicker #f="ngbDatepicker"
          placeholder="Expiration Date" /></div>
      <label for="file-upload" class="custom-file-upload">
        <i class="fa fa-cloud-upload"></i>&nbsp;Upload Document
      </label>
      <input accept="image/x-png,image/gif,image/jpeg" id="file-upload" size="600" type="file"
        (change)="fileChangeEvent($event)" />

      <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="false" [aspectRatio]="4 / 3"
        [resizeToWidth]="0" format="png" (imageCropped)="imageCropped($event)" (imageLoaded)="imageLoaded()"
        (cropperReady)="cropperReady()" (loadImageFailed)="loadImageFailed()"></image-cropper>
      <div (click)="attach(user.icsNo, 'id')" class="my-modal-btn">Upload</div>
    </div>
  </form>
</ng-template>

<ng-template #otherDocContent let-modal>
  <form [formGroup]="insertIdForm">
    <div class="my-modal-header">
      <i (click)="modal.dismiss('Cross click')" class="fal fa-times my-modal-close-btn"></i>
    </div>
    <div class="my-modal-body">
      <div class="my-modal-title">UPLOAD DOCUMENT</div>
      <div>
        <input class="input" type="text" formControlName="docName" placeholder="Document Name" />
      </div>
      <div><input class="input" type="text" formControlName="docNo" placeholder="Document No" /></div>
      <input type="file" (change)="fileChangeEvent($event)" />

      <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="false" [aspectRatio]="4 / 3"
        [resizeToWidth]="0" format="png" (imageCropped)="imageCropped($event)" (imageLoaded)="imageLoaded()"
        (cropperReady)="cropperReady()" (loadImageFailed)="loadImageFailed()"></image-cropper>
      <div (click)="attach(user.icsNo, 'other')" class="my-modal-btn">Upload</div>
    </div>
  </form>
</ng-template>

<!-- <ng-template #action let-modal>
  <div class="my-modal-header">
    <i (click)="modal.dismiss('Cross click')" class="fal fa-times my-modal-close-btn"></i>
  </div>
  <div class="my-modal-body">
    <div *ngIf="currentDocument.permission == '0'" class="my-modal-title">PLEASE WAIT ON USER AUTHORIZATION</div>
    <div *ngIf="currentDocument.permission == null" class="my-modal-title">REQUEST USER PERMISSION TO VIEW THIS
      DOCUMENT?</div>
    <div *ngIf="currentDocument.permission == null" (click)="requestpermission(currentDocument.documentId, currentDocument.userIcsNo);modal.dismiss('click')"
      class="my-modal-btn">
      YES
    </div>
    <div *ngIf="currentDocument.permission == null" (click)="modal.dismiss('click')" class="my-modal-btn">
      NO
    </div>
    <div *ngIf="currentDocument.permission == '0'" (click)="modal.dismiss('click')" class="my-modal-btn">
      OK
    </div>
  </div>
</ng-template> -->